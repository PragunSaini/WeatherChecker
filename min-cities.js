const citiesURL="https://raw.githubusercontent.com/meMo-Minsk/all-countries-and-cities-json/master/countries.json",cityList=[],search=document.querySelector(".search"),suggestions=document.querySelector(".suggestions");function findMatches(e,t){const s=new RegExp(e,"gi");return t.filter(e=>e.name.match(s)||e.country.match(s))}function displayMatches(){if(this.value.trim().length>3){const e=findMatches(this.value,cityList);suggestions.innerHTML=e.map(e=>{const t=new RegExp(this.value,"gi"),s=e.name.replace(t,`<span class="hl">${this.value}</span>`),n=e.country.replace(t,`<span class="hl">${this.value}</span>`);return`<li data-code="${e.code}" id="${e.name}">${s}, ${n}</li>`}).join("")}const e=document.querySelectorAll(".suggestions li");e&&e.forEach(e=>e.addEventListener("click",clickEvent))}function clickEvent(e){search.value=this.id,search.dataset.code=this.dataset.code,suggestions.innerHTML=""}fetch(citiesURL).then(e=>e.json()).then(e=>{Object.keys(e).forEach(t=>{const s=[...new Set(e[t])];"United States"===t&&(t="United States Of America");let n=null;fetch(`https://restcountries.eu/rest/v2/name/${t}?fullText=true&fields=alpha2Code`).then(e=>e.json()).then(e=>{e[0]&&(n=e[0].alpha2Code)}).finally(()=>{s.forEach(e=>{cityList.push({name:e,country:t,code:n})})})})}),search.addEventListener("keyup",displayMatches),search.addEventListener("change",displayMatches);